import{g as k,l as g,o as v,e as m,a as E,P as o,b as W,S as b,c as p,T as u,W as _}from"./window.js";import{invoke as n}from"./core.js";import"./image.js";function d(){return new c(k(),window.__TAURI_INTERNALS__.metadata.currentWebview.label,{skip:!0})}async function y(){return n("plugin:webview|get_all_webviews").then(l=>l.map(e=>new c(new _(e.windowLabel,{skip:!0}),e.label,{skip:!0})))}const w=["tauri://created","tauri://error"];class c{constructor(e,t,i){this.window=e,this.label=t,this.listeners=Object.create(null),i?.skip||n("plugin:webview|create_webview",{windowLabel:e.label,options:{...i,label:t}}).then(async()=>this.emit("tauri://created")).catch(async r=>this.emit("tauri://error",r))}static async getByLabel(e){var t;return(t=(await y()).find(i=>i.label===e))!==null&&t!==void 0?t:null}static getCurrent(){return d()}static async getAll(){return y()}async listen(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:g(e,t,{target:{kind:"Webview",label:this.label}})}async once(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:v(e,t,{target:{kind:"Webview",label:this.label}})}async emit(e,t){if(w.includes(e)){for(const i of this.listeners[e]||[])i({event:e,id:-1,payload:t});return}return m(e,t)}async emitTo(e,t,i){if(w.includes(t)){for(const r of this.listeners[t]||[])r({event:t,id:-1,payload:i});return}return E(e,t,i)}_handleTauriEvent(e,t){return w.includes(e)?(e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t],!0):!1}async position(){return n("plugin:webview|webview_position",{label:this.label}).then(e=>new o(e))}async size(){return n("plugin:webview|webview_size",{label:this.label}).then(e=>new W(e))}async close(){return n("plugin:webview|webview_close",{label:this.label})}async setSize(e){return n("plugin:webview|set_webview_size",{label:this.label,value:e instanceof b?e:new b(e)})}async setPosition(e){return n("plugin:webview|set_webview_position",{label:this.label,value:e instanceof p?e:new p(e)})}async setFocus(){return n("plugin:webview|set_webview_focus",{label:this.label})}async setAutoResize(e){return n("plugin:webview|set_webview_auto_resize",{label:this.label,value:e})}async hide(){return n("plugin:webview|webview_hide",{label:this.label})}async show(){return n("plugin:webview|webview_show",{label:this.label})}async setZoom(e){return n("plugin:webview|set_webview_zoom",{label:this.label,value:e})}async reparent(e){return n("plugin:webview|reparent",{label:this.label,window:typeof e=="string"?e:e.label})}async clearAllBrowsingData(){return n("plugin:webview|clear_all_browsing_data")}async setBackgroundColor(e){return n("plugin:webview|set_webview_background_color",{color:e})}async onDragDropEvent(e){const t=await this.listen(u.DRAG_ENTER,s=>{e({...s,payload:{type:"enter",paths:s.payload.paths,position:new o(s.payload.position)}})}),i=await this.listen(u.DRAG_OVER,s=>{e({...s,payload:{type:"over",position:new o(s.payload.position)}})}),r=await this.listen(u.DRAG_DROP,s=>{e({...s,payload:{type:"drop",paths:s.payload.paths,position:new o(s.payload.position)}})}),f=await this.listen(u.DRAG_LEAVE,s=>{e({...s,payload:{type:"leave"}})});return()=>{t(),r(),i(),f()}}}function A(){const l=d();return new a(l.label,{skip:!0})}async function h(){return n("plugin:window|get_all_windows").then(l=>l.map(e=>new a(e,{skip:!0})))}class a{constructor(e,t={}){var i;this.label=e,this.listeners=Object.create(null),t?.skip||n("plugin:webview|create_webview_window",{options:{...t,parent:typeof t.parent=="string"?t.parent:(i=t.parent)===null||i===void 0?void 0:i.label,label:e}}).then(async()=>this.emit("tauri://created")).catch(async r=>this.emit("tauri://error",r))}static async getByLabel(e){var t;const i=(t=(await h()).find(r=>r.label===e))!==null&&t!==void 0?t:null;return i?new a(i.label,{skip:!0}):null}static getCurrent(){return A()}static async getAll(){return h()}async listen(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:g(e,t,{target:{kind:"WebviewWindow",label:this.label}})}async once(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:v(e,t,{target:{kind:"WebviewWindow",label:this.label}})}async setBackgroundColor(e){return n("plugin:window|set_background_color",{color:e}).then(()=>n("plugin:webview|set_webview_background_color",{color:e}))}}O(a,[_,c]);function O(l,e){(Array.isArray(e)?e:[e]).forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{var r;typeof l.prototype=="object"&&l.prototype&&i in l.prototype||Object.defineProperty(l.prototype,i,(r=Object.getOwnPropertyDescriptor(t.prototype,i))!==null&&r!==void 0?r:Object.create(null))})})}export{a as WebviewWindow,h as getAllWebviewWindows,A as getCurrentWebviewWindow};
